<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>GameDisplay</title><script type="text/javascript" src="/usr/local/share/elm/compiler/elm-runtime.js"></script><script type="text/javascript">Elm.GameDisplay = Elm.GameDisplay || {};
Elm.GameDisplay.make = function (_elm) {
   "use strict";
   _elm.GameDisplay = _elm.GameDisplay || {};
   if (_elm.GameDisplay.values)
   return _elm.GameDisplay.values;
   var _op = {},
   _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "GameDisplay",
   $Basics = Elm.Basics.make(_elm),
   $Color = Elm.Color.make(_elm),
   $GameDraw = Elm.GameDraw.make(_elm),
   $GameModel = Elm.GameModel.make(_elm),
   $Graphics$Collage = Elm.Graphics.Collage.make(_elm),
   $Graphics$Element = Elm.Graphics.Element.make(_elm),
   $List = Elm.List.make(_elm),
   $String = Elm.String.make(_elm),
   $Text = Elm.Text.make(_elm);
   var msg = "SPACE to start, AD to rotate, &uarr;&darr;&larr;&rarr; to move";
   var title = "BUGS ARE HELL";
   var txt = function (f) {
      return function ($) {
         return $Text.centered(f($Text.color($GameDraw.playerColour2)($Text.toText($))));
      };
   };
   var displayScore = function (score) {
      return $Graphics$Collage.move({ctor: "_Tuple2"
                                    ,_0: 0
                                    ,_1: $GameModel.gameHeight / 2})($Graphics$Collage.toForm(A2(txt,
      $Text.height(40),
      $String.show(score))));
   };
   var displayStatus = function (state) {
      return _U.eq(state,
      $GameModel.Pause) ? _L.fromArray([$Graphics$Collage.move({ctor: "_Tuple2"
                                                               ,_0: 0
                                                               ,_1: -80})($Graphics$Collage.toForm(A2(txt,
                                       $Text.height(25),
                                       $Basics.identity(msg))))
                                       ,$Graphics$Collage.move({ctor: "_Tuple2"
                                                               ,_0: 0
                                                               ,_1: 80})($Graphics$Collage.toForm(A2(txt,
                                       $Text.height(40),
                                       $Basics.identity(title))))]) : _L.fromArray([]);
   };
   var fixWeirdAngles = F2(function (_v0,
   shape) {
      return function () {
         return _U.cmp(_v0.spr.sides,
         2) > 0 ? A2($Graphics$Collage.rotate,
         _v0.rot.angle + $Basics.pi / $Basics.toFloat(_v0.spr.sides),
         shape) : A2($Graphics$Collage.rotate,
         _v0.rot.angle + $Basics.pi / 2,
         shape);
      }();
   });
   var displayActor = function (_v2) {
      return function () {
         return fixWeirdAngles(_v2)($Graphics$Collage.move({ctor: "_Tuple2"
                                                           ,_0: _v2.pos.x
                                                           ,_1: _v2.pos.y})(_v2.spr.shape));
      }();
   };
   var displayActors = function (actors) {
      return $List.map(function (actor) {
         return displayActor(actor);
      })(actors);
   };
   var display = F2(function (_v4,
   _v5) {
      return function () {
         return function () {
            switch (_v4.ctor)
            {case "_Tuple2":
               return function () {
                    var displayedActors = _L.append(_L.fromArray([$Graphics$Collage.filled($Color.black)(A2($Graphics$Collage.rect,
                    $Basics.toFloat(_v4._0),
                    $Basics.toFloat(_v4._1)))]),
                    _L.append(_L.fromArray([displayScore(_v5.score)]),
                    _L.append(displayStatus(_v5.state),
                    _L.append(displayActors(_v5.enemies),
                    _L.append(displayActors(_v5.playerBullets),
                    _L.append(displayActors(_v5.enemyBullets),
                    _L.fromArray([displayActor(_v5.player)])))))));
                    return A3($Graphics$Element.container,
                    _v4._0,
                    _v4._1,
                    $Graphics$Element.middle)(A3($Graphics$Collage.collage,
                    _v4._0,
                    _v4._1,
                    displayedActors));
                 }();}
            _E.Case($moduleName,
            "between lines 41 and 51");
         }();
      }();
   });
   _elm.GameDisplay.values = {_op: _op
                             ,fixWeirdAngles: fixWeirdAngles
                             ,displayActor: displayActor
                             ,displayActors: displayActors
                             ,txt: txt
                             ,displayScore: displayScore
                             ,title: title
                             ,msg: msg
                             ,displayStatus: displayStatus
                             ,display: display};
   return _elm.GameDisplay.values;
};</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.GameDisplay)</script><noscript></noscript></body></html>