<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>GameModel</title><script type="text/javascript" src="/usr/local/share/elm/compiler/elm-runtime.js"></script><script type="text/javascript">Elm.GameModel = Elm.GameModel || {};
Elm.GameModel.make = function (_elm) {
   "use strict";
   _elm.GameModel = _elm.GameModel || {};
   if (_elm.GameModel.values)
   return _elm.GameModel.values;
   var _op = {},
   _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "GameModel",
   $Basics = Elm.Basics.make(_elm),
   $GameDraw = Elm.GameDraw.make(_elm),
   $GameEnemies = Elm.GameEnemies.make(_elm),
   $List = Elm.List.make(_elm);
   var setActorBulletVelocity = F4(function (angle$,
   speed$,
   sides,
   _v0) {
      return function () {
         return function () {
            var vel$ = _U.replace([["vx"
                                   ,speed$ * $Basics.cos(angle$)]
                                  ,["vy"
                                   ,speed$ * $Basics.sin(angle$)]],
            _v0.vel);
            return _U.replace([["vel",vel$]
                              ,["speed",speed$]],
            _v0);
         }();
      }();
   });
   var setActorBulletAngle = F2(function (angle$,
   _v2) {
      return function () {
         return function () {
            var rot$ = _U.replace([["angle"
                                   ,angle$]],
            _v2.rot);
            return _U.replace([["rot"
                               ,rot$]],
            _v2);
         }();
      }();
   });
   var createActor = F3(function (x,
   y,
   spr) {
      return {_: {}
             ,accel: 0
             ,deccel: 0
             ,dir: {_: {},x: 0,y: 0}
             ,gun: {_: {}
                   ,fireRate: 0
                   ,firing: false
                   ,timeSince: 0}
             ,kill: false
             ,lives: 1
             ,loseLifeCooldown: 0
             ,loseLifeCooldownMax: 0.5
             ,pos: {_: {},x: x,y: y}
             ,rot: {_: {}
                   ,accel: 0
                   ,angle: 0
                   ,deccel: 0
                   ,speed: 0
                   ,vel: 0}
             ,speed: 0
             ,spr: spr
             ,vel: {_: {},vx: 0,vy: 0}};
   });
   var createPlayer = F2(function (x,
   y) {
      return function () {
         var actor = A3(createActor,
         x,
         y,
         $GameDraw.player);
         return _U.replace([["rot"
                            ,{_: {}
                             ,accel: $Basics.pi / 14
                             ,angle: 0
                             ,deccel: $Basics.pi / 20
                             ,speed: $Basics.pi / 4
                             ,vel: 0}]
                           ,["speed",200]
                           ,["accel",50]
                           ,["deccel",50]
                           ,["gun"
                            ,{_: {}
                             ,fireRate: 12
                             ,firing: false
                             ,timeSince: 0}]
                           ,["lives",4]],
         actor);
      }();
   });
   var createEnemy = F3(function (x,
   y,
   formationDir$) {
      return function () {
         var actor = A3(createActor,
         x,
         y,
         $GameDraw.enemy1);
         return _U.replace([["rot"
                            ,{_: {}
                             ,accel: $Basics.pi / 14
                             ,angle: 0
                             ,deccel: $Basics.pi / 20
                             ,speed: $Basics.pi / 4
                             ,vel: $Basics.pi / 10}]
                           ,["speed",80]
                           ,["accel",20]
                           ,["deccel",5]
                           ,["gun"
                            ,{_: {}
                             ,fireRate: 0.534
                             ,firing: true
                             ,timeSince: 1}]
                           ,["dir",formationDir$]],
         actor);
      }();
   });
   var createEnemyBatch = F3(function (formation,
   pos,
   dir) {
      return $List.map(function (pos$) {
         return A3(createEnemy,
         pos.x + pos$.x,
         pos.y + pos$.y,
         dir);
      })(formation);
   });
   var createActorBullet = F4(function (_v4,
   spr,
   speed$,
   side) {
      return function () {
         return function () {
            var bullet = A3(createActor,
            _v4.pos.x,
            _v4.pos.y,
            spr);
            var angle$ = _v4.rot.angle + 2 * $Basics.pi * $Basics.toFloat(side) / $Basics.toFloat(_v4.spr.sides);
            return A3(setActorBulletVelocity,
            angle$,
            speed$,
            _v4.spr.sides)(setActorBulletAngle(angle$)(bullet));
         }();
      }();
   });
   var createActorBullets = F3(function (actor,
   spr,
   speed) {
      return function () {
         var num = actor.spr.sides;
         return $List.map(function (n) {
            return A4(createActorBullet,
            actor,
            spr,
            speed,
            n);
         })(_L.range(1,num));
      }();
   });
   var createPlayerBullets = function (player) {
      return A3(createActorBullets,
      player,
      $GameDraw.playerBullet1,
      600);
   };
   var createEnemyBullets = function (enemy) {
      return A3(createActorBullets,
      enemy,
      $GameDraw.enemyBullet1(enemy),
      100);
   };
   var $ = {ctor: "_Tuple2"
           ,_0: 400
           ,_1: 300},
   halfWidth = $._0,
   halfHeight = $._1;
   var createPlayerLivesUI = function (num) {
      return function () {
         var step = 60;
         var $ = {ctor: "_Tuple2"
                 ,_0: 0 - halfWidth + 10
                 ,_1: halfHeight - 10},
         x = $._0,
         y = $._1;
         return $List.map(function (n) {
            return A3(createActor,
            $Basics.toFloat(x) + $Basics.toFloat(n - 1) * step,
            $Basics.toFloat(y),
            $GameDraw.playerLife);
         })(_L.range(1,num));
      }();
   };
   var $ = {ctor: "_Tuple2"
           ,_0: 800
           ,_1: 600},
   gameWidth = $._0,
   gameHeight = $._1;
   var GameState = F9(function (a,
   b,
   c,
   d,
   e,
   f,
   g,
   h,
   i) {
      return {_: {}
             ,enemies: d
             ,enemyBullets: e
             ,player: b
             ,playerBullets: c
             ,score: f
             ,seeds: i
             ,spawnCooldown: g
             ,state: a
             ,ui: h};
   });
   var Lost = {ctor: "Lost"};
   var Won = {ctor: "Won"};
   var Pause = {ctor: "Pause"};
   var defaultGame = function () {
      var player$ = A2(createPlayer,
      0,
      0);
      return {_: {}
             ,enemies: _L.fromArray([])
             ,enemyBullets: _L.fromArray([])
             ,player: player$
             ,playerBullets: _L.fromArray([])
             ,score: 0
             ,seeds: {_: {}
                     ,a: 1
                     ,b: 2
                     ,c: 3
                     ,d: 4}
             ,spawnCooldown: 0
             ,state: Pause
             ,ui: {_: {}
                  ,lives: createPlayerLivesUI(player$.lives)}};
   }();
   var Play = {ctor: "Play"};
   var Seeds = F4(function (a,
   b,
   c,
   d) {
      return {_: {}
             ,a: a
             ,b: b
             ,c: c
             ,d: d};
   });
   var Level = F2(function (a,b) {
      return {_: {}
             ,enemies: b
             ,name: a};
   });
   var UI = function (a) {
      return {_: {},lives: a};
   };
   var EnemyGroup = F3(function (a,
   b,
   c) {
      return {_: {}
             ,enemies: a
             ,formation: b
             ,target: c};
   });
   var Actor = function (a) {
      return function (b) {
         return function (c) {
            return function (d) {
               return function (e) {
                  return function (f) {
                     return function (g) {
                        return function (h) {
                           return function (i) {
                              return function (j) {
                                 return function (k) {
                                    return function (l) {
                                       return function (m) {
                                          return {_: {}
                                                 ,accel: e
                                                 ,deccel: f
                                                 ,dir: m
                                                 ,gun: h
                                                 ,kill: l
                                                 ,lives: i
                                                 ,loseLifeCooldown: j
                                                 ,loseLifeCooldownMax: k
                                                 ,pos: a
                                                 ,rot: c
                                                 ,speed: d
                                                 ,spr: g
                                                 ,vel: b};
                                       };
                                    };
                                 };
                              };
                           };
                        };
                     };
                  };
               };
            };
         };
      };
   };
   var Gun = F3(function (a,b,c) {
      return {_: {}
             ,fireRate: b
             ,firing: a
             ,timeSince: c};
   });
   var Rotation = F5(function (a,
   b,
   c,
   d,
   e) {
      return {_: {}
             ,accel: d
             ,angle: a
             ,deccel: e
             ,speed: b
             ,vel: c};
   });
   var Velocity = F2(function (a,
   b) {
      return {_: {},vx: a,vy: b};
   });
   var Direction = F2(function (a,
   b) {
      return {_: {},x: a,y: b};
   });
   var Position = F2(function (a,
   b) {
      return {_: {},x: a,y: b};
   });
   _elm.GameModel.values = {_op: _op
                           ,Position: Position
                           ,Direction: Direction
                           ,Velocity: Velocity
                           ,Rotation: Rotation
                           ,Gun: Gun
                           ,Actor: Actor
                           ,EnemyGroup: EnemyGroup
                           ,UI: UI
                           ,Level: Level
                           ,Seeds: Seeds
                           ,Play: Play
                           ,Pause: Pause
                           ,Won: Won
                           ,Lost: Lost
                           ,GameState: GameState
                           ,gameHeight: gameHeight
                           ,gameWidth: gameWidth
                           ,halfHeight: halfHeight
                           ,halfWidth: halfWidth
                           ,createActor: createActor
                           ,createPlayer: createPlayer
                           ,createEnemy: createEnemy
                           ,createEnemyBatch: createEnemyBatch
                           ,setActorBulletAngle: setActorBulletAngle
                           ,setActorBulletVelocity: setActorBulletVelocity
                           ,createActorBullet: createActorBullet
                           ,createActorBullets: createActorBullets
                           ,createPlayerBullets: createPlayerBullets
                           ,createEnemyBullets: createEnemyBullets
                           ,createPlayerLivesUI: createPlayerLivesUI
                           ,defaultGame: defaultGame};
   return _elm.GameModel.values;
};</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.GameModel)</script><noscript></noscript></body></html>